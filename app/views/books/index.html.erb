<h1>家計簿</h1>

<div class="card"> 
    <div class="card-body">
        <%= form_with method: "get" , local: true do |f| %>
        <div class="form-row">
            <div class="col">
                <%= f.number_field "year" , placeholder: "年度を入力", class: "form-control" %>
            </div>
            
            <div class="col">
                <%= f.number_field "month" , placeholder: "対象月を入力", class: "form-control" %>
            </div>
            
            <div class="col">
                <%= f.submit "検索" , class: "btn btn-primary" %>
            </div>
        </div>
        <% end %>
        </div>
</div>
<!--新規登録画面へのリンクをつけている
new_bookはroutes.rbで定義した新規画面のURLニックネーム。pathをつける事でURLを返すメソッドになる-->
<%= link_to "+新規", new_book_path, class: "btn btn-success" %>
<table class="table table-striped">
    <!--trは表全体-->
    <tr>
        <!--thはtable headerの略。表内で見出しになるものに使う-->
        <th>年月</th>
        <th>区分</th>
        <th>科目</th>
        <th>金額</th>
        <th>リンク</th>
    </tr>
    <% sum = 0 %>
    <!--eachでdo～endの中は繰り返し処理を行う
    配列から1つずつ要素を取りだしbookへ代入している-->
    <% @books.each do |book| %>
    <tr>
        <!--tdはtable dataの略。データが入っているものに使う-->
        <!--book.yearは年データをbook.monthは月取り出している-->
        <td><%= book.year %>年<%= book.month %>月</td>
        <!--inoutは支出、収入の数値データをさす-->
        <td><%= book.inout %></td>
        <!--categoryは科目種類-->
        <td><%= book.category %></td>
        <!--amountは金額数値-->
        <td><%= book.amount %>万円</td>
        <td>
            <!--詳細リンクの追加。btn btn-infoは青いボタンになる-->
            <%= link_to "詳細", book_path(book), class: "btn btn-info" %>
            <!--編集リンクの追加。btn btn-warningは黄色いボタンになる-->
            <%= link_to "編集", edit_book_path(book), class: "btn btn-warning" %>
            <!--削除する際確認の画面表示をする-->
            <%= link_to "削除", book_path(book), method: "delete", data: { confirm: '本当に削除しますか？' }, class: "btn btn-danger" %>
        </td>
    </tr>
     <% if book.inout == 1 %>
        <% sum += book.amount %>
     <% else %>
      <% sum -= book.amount %>
     <% end %>
    <% end %>
  
 
    <tr>
        <td></td>
        <td></td>
        <td>収入合計</td>
        <td><%= sum %>万円</td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>支出合計</td>
        <td><%= sum %>万円</td>
        <td></td>
    </tr>
    <tr>
        <td></td>
        <td></td>
        <td>合計</td>
        <td><%= sum %>万円</td>
        <td></td>
    </tr>
</table>